

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Excel &mdash; gh-pages  ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="../../genindex.html"/>
        <link rel="search" title="検索" href="../../search.html"/>
    <link rel="top" title="gh-pages  ドキュメント" href="../../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> gh-pages
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Excel</a></li>
<li><a class="reference internal" href="#object">Object</a></li>
<li><a class="reference internal" href="#enviroment">Enviroment</a><ul>
<li><a class="reference internal" href="#os">OS</a></li>
<li><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vbe">VBE</a><ul>
<li><a class="reference internal" href="#development-menu">Development Menu</a></li>
</ul>
</li>
<li><a class="reference internal" href="#">標準モジュールの追加</a></li>
<li><a class="reference internal" href="#file-extensions">file extensions</a></li>
<li><a class="reference internal" href="#processing-cell">Processing Cell</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gh-pages</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Excel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/contents/qiita/Excel VBA.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<p>英語で書いたまとめと基本的な文法など</p>
<ul class="simple">
<li>Visual Basic for Applications</li>
<li>programming language</li>
</ul>
<div class="section" id="excel">
<span id="excel"></span><h1>Excel<a class="headerlink" href="#excel" title="このヘッドラインへのパーマリンク">¶</a></h1>
<ul class="simple">
<li>book</li>
<li>sheet</li>
<li>cell</li>
</ul>
<p>These are objects in VBA.</p>
</div>
<div class="section" id="object">
<span id="object"></span><h1>Object<a class="headerlink" href="#object" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>Objects have properties and methods.</p>
</div>
<div class="section" id="enviroment">
<span id="enviroment"></span><h1>Enviroment<a class="headerlink" href="#enviroment" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="os">
<span id="os"></span><h2>OS<a class="headerlink" href="#os" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Windows 7</p>
</div>
<div class="section" id="version">
<span id="version"></span><h2>version<a class="headerlink" href="#version" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Excel 2013</p>
</div>
</div>
<div class="section" id="vbe">
<span id="vbe"></span><h1>VBE<a class="headerlink" href="#vbe" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>VBE is Visual Basic Editor. How do I use this editor?</p>
<div class="section" id="development-menu">
<span id="development-menu"></span><h2>Development Menu<a class="headerlink" href="#development-menu" title="このヘッドラインへのパーマリンク">¶</a></h2>
<ol class="simple">
<li>Open Excel&#8217;s options. Select File menu and then click Options.</li>
<li>Select the Ribbon settings. (Customize Ribbon)</li>
<li>Check the Development checkbox.</li>
</ol>
<p>Accept your changes until you return to the Ribbon. You should now see the development tab.</p>
</div>
</div>
<div class="section" id="">
<span id="id1"></span><h1>標準モジュールの追加<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>[挿入]-[標準モジュール]</p>
</div>
<div class="section" id="file-extensions">
<span id="file-extensions"></span><h1>file extensions<a class="headerlink" href="#file-extensions" title="このヘッドラインへのパーマリンク">¶</a></h1>
<ul class="simple">
<li>bas</li>
<li>frm</li>
<li>cls</li>
<li>ctl</li>
<li>pag</li>
<li>dob</li>
<li>dsr</li>
<li>vb</li>
</ul>
<div class="highlight-vb"><div class="highlight"><pre><span></span>Attribute VB_Name = &quot;Module1&quot;
Option Explicit
&#39; 変数宣言の強制

&#39; ユーザー定義型
Type user
    name As String
    birthDateTime As Date
    birthDate As Date
    birthTime As Date
End Type


Sub Main()
    &#39; comment
    Debug.Print &quot;Open imediate window.&quot;

    &#39; 数値
    Dim int_val As Integer
    Dim long_val As Long
    Dim single_val As Single
    Dim double_val As Double
    Debug.Print &quot;init: &quot; &amp; int_val &amp; long_val &amp; single_val &amp; double_val
    
    int_val = 5
    long_val = 6000
    single_val = 0.71
    double_val = 8.2
    Debug.Print Format(int_val, &quot;Currency&quot;)
    Debug.Print Format(long_val, &quot;Fixed&quot;)
    Debug.Print Format(long_val, &quot;Standard&quot;)
    Debug.Print Format(single_val, &quot;Percent&quot;)
    Debug.Print Format(0, &quot;Yes/No&quot;)
    Debug.Print Format(1, &quot;Yes/No&quot;)
    Debug.Print Format(0, &quot;True/False&quot;)
    Debug.Print Format(2, &quot;True/False&quot;)
    Debug.Print Format(0, &quot;On/Off&quot;)
    Debug.Print Format(-1, &quot;On/Off&quot;)
    &#39;printf -&gt; http://www.freevbcode.com/ShowCode.asp?ID=5014

    Debug.Print &quot;5 + 2 = &quot; &amp; (int_val + 2)
    Debug.Print &quot;5 - 2 = &quot; &amp; (int_val - 2)
    Debug.Print &quot;5 * 2 = &quot; &amp; (int_val * 2)
    Debug.Print &quot;-5 * -2 = &quot; &amp; (-int_val * -2)
    Debug.Print &quot;5 / 2 = &quot; &amp; (int_val / 2)
    Debug.Print &quot;5 \ 2 = &quot; &amp; (int_val \ 2)
    Debug.Print &quot;5 mod 2 = &quot; &amp; (int_val Mod 2)
    Debug.Print &quot;5 ^ 2 = &quot; &amp; (int_val ^ 2)
    
    &#39; Boolean
    Dim bool_f As Boolean
    Dim bool_t As Boolean
    Debug.Print &quot;init: &quot; &amp; bool_t

    bool_f = False
    bool_t = True
    Debug.Print &quot;False And False is &quot; &amp; (bool_f And bool_f)
    Debug.Print &quot;False And True  is &quot; &amp; (bool_f And bool_t)
    Debug.Print &quot;True  And False is &quot; &amp; (bool_t And bool_f)
    Debug.Print &quot;True  And True  is &quot; &amp; (bool_t And bool_t)
    
    Debug.Print &quot;False Or False is &quot; &amp; (bool_f Or bool_f)
    Debug.Print &quot;False Or True  is &quot; &amp; (bool_f Or bool_t)
    Debug.Print &quot;True  Or False is &quot; &amp; (bool_t Or bool_f)
    Debug.Print &quot;True  Or True  is &quot; &amp; (bool_t Or bool_t)
    
    Debug.Print &quot;Not True  is &quot; &amp; (Not bool_t)
    Debug.Print &quot;Not False is &quot; &amp; (Not bool_f)
    
    Debug.Print &quot;int_val = long_val is &quot; &amp; (int_val = long_val)
    Debug.Print &quot;int_val &lt;&gt; long_val is &quot; &amp; (int_val &lt;&gt; long_val)
    Debug.Print &quot;single_val &gt;= double_val is &quot; &amp; (single_val &gt;= double_val)
    Debug.Print &quot;single_val &lt;= double_val is &quot; &amp; (int_val &lt;= double_val)
    Debug.Print &quot;int_val = int_val is &quot; &amp; (int_val = int_val)
    Debug.Print &quot;Not False is &quot; &amp; (Not bool_f)
    Debug.Print &quot;Not False is &quot; &amp; (Not bool_f)
    Debug.Print &quot;Not False is &quot; &amp; (Not bool_f)
    Debug.Print &quot;Not False is &quot; &amp; (Not bool_f)
    
    If False Then
        Debug.Print &quot;If&quot;
    ElseIf False Then
        Debug.Print &quot;ElseIf&quot;
    Else
        Debug.Print &quot;Else&quot;
    End If

    &#39; 文字列型
    Dim hello As String
    Dim world As String
    Dim refVal As String
    Debug.Print &quot;init: [&quot; &amp; hello &amp; &quot;]&quot;
    
    hello = &quot;Hello&quot;
    world = &quot;World&quot;
    refVal = &quot;refVal&quot;
    MySubMsgBox hello, world, refVal
    Debug.Print world
    Debug.Print refVal
    Debug.Print MyFuncLen(hello)
    Debug.Print MyFuncLen(hello, 2)
    ExitInSub
    Debug.Print ExitInFunction
    Debug.Print RecursiveFactorial(4)
    
    &#39; 配列
    Dim fixary(2) As String
    fixary(0) = &quot;ab&quot;
    fixary(1) = &quot;cd&quot;
    Dim joined As String
    joined = Join(fixary, &quot;,&quot;)
    Debug.Print joined
    
    &#39; Loop
    Dim varary() As String
    varary = Split(joined, &quot;,&quot;)
    varary(2) = &quot;gh&quot;
    Dim str As Variant
    For Each str In varary
        Debug.Print str
    Next str
    Dim idx As Integer
    For idx = 0 To UBound(varary) Step 2
        Debug.Print idx &amp; &quot;:&quot; &amp; varary(idx)
    Next idx
    
    Dim i As Integer
    Do
        i = i + 1
        Debug.Print &quot;do statement while:&quot; &amp; i
    Loop While False
    Do
        i = i + 1
        Debug.Print &quot;do statement until:&quot; &amp; i
    Loop Until True
    Do While i &lt; 4
        i = i + 1
        Debug.Print &quot;do while statement:&quot; &amp; i
    Loop
    Do Until i = 1
        i = i - 1
        Debug.Print &quot;do until statement:&quot; &amp; i
    Loop
    
    &#39; 日付型
    Dim date_val As Date
    Debug.Print &quot;init: &quot; &amp; date_val
    
    Dim my As user
    Debug.Print &quot;my.name type: &quot; &amp; TypeName(my.name)
    Debug.Print &quot;my.birthDateTime type: &quot; &amp; TypeName(my.birthDateTime)
    &#39; Debug.Print &quot;my type: &quot; &amp; TypeName(my)
    &#39; パブリックオブジェクトモジュール?
    
    my.name = &quot;my name&quot;
    my.birthDateTime = #11/12/2014 1:02:03 AM#
    my.birthDate = #11/12/2014#
    my.birthTime = #1:02:03 AM#
    date_val = #1:24:35 PM#
    Debug.Print &quot;DateTime: &quot; &amp; my.birthDateTime
    Debug.Print &quot;Date: &quot; &amp; my.birthDate
    Debug.Print &quot;AM Time: &quot; &amp; my.birthTime
    Debug.Print &quot;PM Time: &quot; &amp; date_val
    Debug.Print vbCrLf &amp; Chr(13) &amp; Chr(10)

    my.birthDateTime = &quot;2014/12/11 01:02:03 AM&quot;
    my.birthDate = &quot;2014/12/11&quot;
    my.birthTime = &quot;1:02:03 AM&quot;
    date_val = &quot;01:24:35 PM&quot;
    Debug.Print &quot;DateTime: &quot; &amp; my.birthDateTime
    Debug.Print &quot;Date: &quot; &amp; my.birthDate
    Debug.Print &quot;AM Time: &quot; &amp; my.birthTime
    Debug.Print &quot;PM Time: &quot; &amp; date_val

    Debug.Print &quot;my.birthDateTime(from str) type: &quot; &amp; TypeName(my.birthDateTime)
    Debug.Print &quot;DateTime(from str) type: &quot; &amp; TypeName(&quot;2014/12/11 01:02:03 AM&quot;)
    Debug.Print &quot;DateTime(from str) type(Casted): &quot; &amp; TypeName(CDate(&quot;2014/12/11 01:02:03 AM&quot;))
    Debug.Print &quot;DateTime(from str) isDate: &quot; &amp; IsDate(&quot;2014/12/11 01:02:03 AM&quot;)
    Debug.Print &quot;DateTime(from str) isDate(Casted): &quot; &amp; IsDate(CDate(&quot;2014/12/11 01:02:03 AM&quot;))

End Sub

&#39; no return value
Sub MySubMsgBox(ByVal str1 As String, ByVal str2 As String, refVal As String)
    refVal = &quot;参照渡し&quot;
    str2 = str2 &amp; &quot;!&quot;
    MsgBox str1 &amp; &quot;_&quot; &amp; str2
End Sub

Sub ExitInSub()
    Debug.Print &quot;Before Exit Sub&quot;
    Exit Sub
    Debug.Print &quot;After Exit Sub&quot;
End Sub

&#39; exists return value
Function MyFuncLen(ByVal str As String, Optional ByVal opt As Integer) As Integer
    MyFuncLen = Len(str) + opt
End Function

Function ExitInFunction() As String
    ExitInFunction = &quot;Before Exit Function&quot;
    Exit Function
    ExitInFunction = &quot;After Exit Function&quot;
End Function

Function RecursiveFactorial(ByVal num As Integer) As Integer
    If num &lt;= 0 Then
        RecursiveFactorial = 1
    Else
        RecursiveFactorial = num * RecursiveFactorial(num - 1)
    End If
End Function
</pre></div>
</div>
<div class="highlight-vb"><div class="highlight"><pre><span></span>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  &#39;True
END
Attribute VB_Name = &quot;Class1&quot;
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
</pre></div>
</div>
<div class="highlight-vb"><div class="highlight"><pre><span></span>VERSION 5.00
Begin {xxxxxx} UserForm1 
   Caption         =   &quot;UserForm1&quot;
   ClientHeight    =   3180
   ClientLeft      =   45
   ClientTop       =   375
   ClientWidth     =   4710
   OleObjectBlob   =   &quot;UserForm1.frx&quot;:0000
   StartUpPosition =   1  &#39;オーナー フォームの中央
End
Attribute VB_Name = &quot;UserForm1&quot;
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
</pre></div>
</div>
</div>
<div class="section" id="processing-cell">
<span id="processing-cell"></span><h1>Processing Cell<a class="headerlink" href="#processing-cell" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="highlight-vb"><div class="highlight"><pre><span></span>Sub Main()
    &#39; select sheet
    Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).Value = &quot;a1&quot;
    
    &#39; selected sheet
    Range(&quot;A2&quot;).Value = &quot;a2&quot;
    Cells(3, 1).Value = &quot;a3&quot;
    Cells(3, 1).Offset(1, 1).Value = &quot;b4&quot;
    
    &#39; cells
    Range(&quot;A5&quot;, &quot;B6&quot;).Value = &quot;a5 to b6&quot;
    Range(&quot;A7:C8&quot;).Value = &quot;a7 to c8&quot;
    
    &#39; row, column
    Range(&quot;9:9&quot;).Value = &quot;row9&quot;
    &#39; Range(&quot;D:D&quot;).Value = &quot;col D&quot;
    Range(&quot;B9&quot;).Clear
    Range(&quot;A10&quot;).Value = &quot;A10&quot;
    
    &#39; with
    Dim ary As Variant
    Dim str As Variant
    ary = Array(&quot;C1-red&quot;, &quot;D1-blue&quot;, &quot;E1-green&quot;, &quot;F1-other&quot;)
    For Each str In ary
        Dim c As Range
        Dim posColor As Variant
        posColor = Split(str, &quot;-&quot;)
        Set c = Range(posColor(0))
        With c
            .Value = posColor(0)
            With .Font
                .Bold = True
                .Size = 16
            End With
            .Interior.color = color(c:=posColor(1))
        End With
    Next str
    
    &#39; named arguments
    Range(&quot;A9&quot;).Delete shift:=xlShiftUp
            
    &#39; dialog box
    btnVal = MsgBox(&quot;すべてのセルを初期化しますか？&quot; _
        , vbOKCancel, &quot;セルの初期化&quot;)
    If btnVal = vbOK Then
        Cells.Clear
    End If
        
End Sub

Function color(ByVal c As String) As Long
    Select Case c
    Case &quot;red&quot;
        color = vbRed
    Case &quot;blue&quot;
        color = vbBlue
    Case &quot;green&quot;
        color = vbGreen
    Case Else
        color = vbWhite
    End Select
End Function
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, ksomemo.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>