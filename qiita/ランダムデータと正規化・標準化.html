

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>データ準備用 &mdash; gh-pages  ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="検索" href="../search.html"/>
    <link rel="top" title="gh-pages  ドキュメント" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> gh-pages
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">データ準備用</a></li>
<li><a class="reference internal" href="#">データ準備と準備してからの標準化</a><ul>
<li><a class="reference internal" href="#">余談</a><ul>
<li><a class="reference internal" href="#">平均を0にする</a></li>
<li><a class="reference internal" href="#">分散を1にする</a><ul>
<li><a class="reference internal" href="#">平均が0のとき</a></li>
<li><a class="reference internal" href="#">平均がμのとき</a></li>
</ul>
</li>
<li><a class="reference internal" href="#">もう１つの正規化を考える</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#quantile">quantile</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gh-pages</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>データ準備用</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/qiita/ランダムデータと正規化・標準化.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="">
<span id="id1"></span><h1>データ準備用<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="highlight-py3:random.py"><div class="highlight"><pre><span></span>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

%matplotlib inline

# [0, 1)
np.random.rand(nrow, ncol)

# 1~100の範囲を重複アリで10個ランダム
np.random.randint(1, 100, 10)

# 正規分布
norm_data = np.random.randn(1, 10000)[0]
pd.Series(norm_data[0], name=&quot;a&quot;).hist()
</pre></div>
</div>
<p><img alt="image" src="https://qiita-image-store.s3.amazonaws.com/0/6982/d4ff58d7-20c8-a54e-2cd9-53dd4a6d2778.png" /></p>
</div>
<div class="section" id="">
<span id="id2"></span><h1>データ準備と準備してからの標準化<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="highlight-py3:df.py"><div class="highlight"><pre><span></span>import string

np.random.seed(0)
data = {
    &quot;a&quot;: range(1, 1000+1),
    &quot;b&quot;: list(string.ascii_letters[:25] * 40),
    &quot;c&quot;: [1,2,3,4] * 250,
    &quot;d&quot;: np.random.rand(1000),
    &quot;e&quot;: np.random.randn(1000),
    &quot;f&quot;: np.random.randint(1, 100, 1000)
}
df = pd.DataFrame(data)

# カテゴリ変数化
df[&quot;c&quot;].head(1)
# 0    1
# Name: c, dtype: int64

df[&quot;c&quot;] = df.c.astype(&quot;category&quot;)
df[&quot;c&quot;].head(1)
# 0    1
# Name: c, dtype: category
# Categories (4, int64): [1, 2, 3, 4]
</pre></div>
</div>
<div class="highlight-py3:standardization.py"><div class="highlight"><pre><span></span>from sklearn.preprocessing import scale
# normalize はベクトルの正規化だった
figure, axes = plt.subplots(1, 3, figsize=(15, 5))
df[&quot;f&quot;].hist(ax=axes[0])
(df.f - df.f.mean()).div(df.f.std()).hist(ax=axes[1])
plt.hist(scale(df[&quot;f&quot;].astype(&quot;float&quot;)))
</pre></div>
</div>
<p><img alt="image" src="https://qiita-image-store.s3.amazonaws.com/0/6982/51d55aaf-6b86-efe6-a46c-550c66930d34.png" /></p>
<div class="section" id="">
<span id="id3"></span><h2>余談<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="">
<span id="id4"></span><h3>平均を0にする<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ol class="simple">
<li>各データの合計を要素数で割ると平均になる</li>
<li>つまり割る前は要素数×平均になっている</li>
<li>つまり各要素から平均を引けば、平均は0になる</li>
</ol>
</div>
<div class="section" id="">
<span id="id5"></span><h3>分散を1にする<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>$\mathrm{Var}[X] = E[(X-\mu)^2] = \dfrac{1}{n}\displaystyle\sum_{i=1}^n(x_i-\mu)^2$
$ \sigma = \sqrt[]{Var[X]} $</p>
<div class="section" id="">
<span id="id6"></span><h4>平均が0のとき<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>標準化しても分子変わらないので、標準化後の平均は0のまま</li>
<li>$Var[X/\sigma] = \dfrac{1}{n}\displaystyle\sum_{i=1}^n(x_i/\sigma - 0)^2 $</li>
<li>上記にて、$\sigma$はindex $i$に関係ないので$\sum$の外に出せる</li>
<li>$\dfrac{1}{\sigma^2}\dfrac{1}{n}\displaystyle\sum_{i=1}^n(x_i - 0)^2 $</li>
<li>上記は$\dfrac{1}{\sigma^2}Var[X] $ より 1となる</li>
</ul>
</div>
<div class="section" id="">
<span id="id7"></span><h4>平均がμのとき<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h4>
<ul class="simple">
<li>標準化後の平均は全ての要素が $1/\sigma$ より $\mu/\sigma$</li>
<li>$Var[X/\sigma] = \dfrac{1}{n}\displaystyle\sum_{i=1}^n(x_i/\sigma - \mu/\sigma)^2 $</li>
<li>$ (x_i/\sigma - \mu/\sigma)^2 = \dfrac{(x_i - \mu)^2}{\sigma^2} $</li>
<li>より平均0のときと同様に展開して分散は1となる</li>
</ul>
</div>
</div>
<div class="section" id="">
<span id="id8"></span><h3>もう１つの正規化を考える<a class="headerlink" href="#" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>$(x_i - x_{min})/(x_{max} - x_{min})$</p>
<ol class="simple">
<li>最小値を各要素から引く</li>
<li>引く前の最小値はもちろん最小値なので、その後の最小値は0になる</li>
<li>最大値は最大値と最小値の差分となる</li>
<li>最大値と最小値の差分をとり、各要素から最小値を引いた値を割る</li>
<li>最大値は項2より差分で割ると1になる</li>
<li>最小値は0なので変わらず0である</li>
<li>これより0〜1の範囲になった</li>
</ol>
</div>
</div>
</div>
<div class="section" id="quantile">
<span id="quantile"></span><h1>quantile<a class="headerlink" href="#quantile" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><a class="reference external" href="http://qiita.com/ksomemo/items/f658742a18ad804caa5f">階級作成とDummy変数の作成</a>でやったqcutとほぼ同じだけど集約される。</p>
<div class="highlight-py3:decile.py"><div class="highlight"><pre><span></span># 10分位
decile = list(map(lambda x: x / 10, range(0, 10+1)))
decile

    a   d   e   f
0.0 1.0 0.000546    -2.994613   1
0.1 100.9   0.100287    -1.198404   9
0.2 200.8   0.203938    -0.825520   22
0.3 300.7   0.292981    -0.481149   33
0.4 400.6   0.383455    -0.199363   41
0.5 500.5   0.481323    0.030935    51
0.6 600.4   0.588486    0.245125    60
0.7 700.3   0.696379    0.501393    69
0.8 800.2   0.806419    0.835011    79
0.9 900.1   0.907747    1.324424    89
1.0 1000.0  0.999809    3.170975    99
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, ksomemo.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>